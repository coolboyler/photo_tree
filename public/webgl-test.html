<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGLè¯Šæ–­å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #000;
            color: #fff;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: #f0abfc;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .result {
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
        .success {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid rgba(0, 255, 0, 0.3);
            color: #4ade80;
        }
        .warning {
            background: rgba(255, 255, 0, 0.1);
            border: 1px solid rgba(255, 255, 0, 0.3);
            color: #fbbf24;
        }
        .error {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
            color: #f87171;
        }
        .button {
            background: linear-gradient(135deg, #f0abfc, #c026d3);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            text-decoration: none;
            display: inline-block;
        }
        .button:hover {
            background: linear-gradient(135deg, #e879f9, #a21caf);
        }
        .test-canvas {
            border: 2px solid #444;
            margin: 10px 0;
            display: block;
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .info-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 10px;
            border-radius: 5px;
        }
        .info-label {
            color: #a78bfa;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .info-value {
            color: #e5e7eb;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ WebGLè¯Šæ–­å·¥å…·</h1>

        <div class="section">
            <h2>WebGLæ”¯æŒæ£€æµ‹</h2>
            <div id="webgl-result" class="result">æ£€æµ‹ä¸­...</div>
            <canvas id="test-canvas" class="test-canvas" width="200" height="100"></canvas>
            <button class="button" onclick="testWebGL()">é‡æ–°æ£€æµ‹</button>
        </div>

        <div class="section">
            <h2>æµè§ˆå™¨ä¿¡æ¯</h2>
            <div class="info-grid" id="browser-info">
                <!-- æµè§ˆå™¨ä¿¡æ¯å°†é€šè¿‡JavaScriptå¡«å…… -->
            </div>
        </div>

        <div class="section">
            <h2>GPUä¿¡æ¯</h2>
            <div class="info-grid" id="gpu-info">
                <!-- GPUä¿¡æ¯å°†é€šè¿‡JavaScriptå¡«å…… -->
            </div>
        </div>

        <div class="section">
            <h2>æ€§èƒ½æµ‹è¯•</h2>
            <div id="performance-result" class="result">å‡†å¤‡æµ‹è¯•...</div>
            <button class="button" onclick="runPerformanceTest()">è¿è¡Œæ€§èƒ½æµ‹è¯•</button>
            <button class="button" onclick="testThreeJS()">æµ‹è¯•Three.jsæ¸²æŸ“</button>
        </div>

        <div class="section">
            <h2>è§£å†³æ–¹æ¡ˆ</h2>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Chromeæµè§ˆå™¨</div>
                    <div class="info-value">
                        1. åœ°å€æ è¾“å…¥: chrome://settings/system<br>
                        2. å¼€å¯"ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿæ¨¡å¼(å¦‚æœå¯ç”¨)"<br>
                        3. é‡å¯æµè§ˆå™¨
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-label">Firefoxæµè§ˆå™¨</div>
                    <div class="info-value">
                        1. åœ°å€æ è¾“å…¥: about:config<br>
                        2. æœç´¢: webgl.disabled<br>
                        3. ç¡®ä¿å€¼ä¸º false
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-label">Edgeæµè§ˆå™¨</div>
                    <div class="info-value">
                        1. åœ°å€æ è¾“å…¥: edge://settings/system<br>
                        2. å¼€å¯"ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿ(å¦‚æœå¯ç”¨)"<br>
                        3. é‡å¯æµè§ˆå™¨
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-label">é€šç”¨è§£å†³æ–¹æ¡ˆ</div>
                    <div class="info-value">
                        1. æ›´æ–°æ˜¾å¡é©±åŠ¨ç¨‹åº<br>
                        2. å…³é—­å…¶ä»–å ç”¨GPUçš„åº”ç”¨<br>
                        3. é‡å¯ç”µè„‘<br>
                        4. å°è¯•å…¶ä»–æµè§ˆå™¨
                    </div>
                </div>
            </div>
        </div>

        <div class="section" style="text-align: center;">
            <button class="button" onclick="window.location.href='/'">è¿”å›3Dåœ£è¯æ ‘</button>
            <button class="button" onclick="window.open('https://get.webgl.org/', '_blank')">WebGLå®˜æ–¹æµ‹è¯•</button>
        </div>
    </div>

    <script>
        // æ£€æµ‹WebGLæ”¯æŒ
        function testWebGL() {
            const canvas = document.getElementById('test-canvas');
            const resultDiv = document.getElementById('webgl-result');

            try {
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');

                if (gl) {
                    // æµ‹è¯•æ¸²æŸ“
                    gl.clearColor(0.2, 0.4, 0.8, 1.0);
                    gl.clear(gl.COLOR_BUFFER_BIT);

                    const info = gl.getExtension('WEBGL_debug_renderer_info');
                    const renderer = info ? gl.getParameter(info.UNMASKED_RENDERER_WEBGL) : 'æœªçŸ¥';
                    const vendor = info ? gl.getParameter(info.UNMASKED_VENDOR_WEBGL) : 'æœªçŸ¥';

                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        âœ… WebGLæ”¯æŒæ­£å¸¸<br>
                        <strong>æ¸²æŸ“å™¨:</strong> ${renderer}<br>
                        <strong>ä¾›åº”å•†:</strong> ${vendor}<br>
                        <strong>ç‰ˆæœ¬:</strong> ${gl.getParameter(gl.VERSION)}<br>
                        <strong>ç€è‰²å™¨ç‰ˆæœ¬:</strong> ${gl.getParameter(gl.SHADING_LANGUAGE_VERSION)}
                    `;

                    // æ›´æ–°GPUä¿¡æ¯
                    updateGPUInfo(renderer, vendor);
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = 'âŒ WebGLä¸æ”¯æŒæˆ–å·²è¢«ç¦ç”¨';
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `âŒ WebGLæ£€æµ‹å¤±è´¥: ${error.message}`;
            }
        }

        // æ›´æ–°æµè§ˆå™¨ä¿¡æ¯
        function updateBrowserInfo() {
            const browserInfo = document.getElementById('browser-info');
            const userAgent = navigator.userAgent;

            let browserName = 'æœªçŸ¥';
            let browserVersion = 'æœªçŸ¥';
            let os = 'æœªçŸ¥';

            // æ£€æµ‹æµè§ˆå™¨
            if (userAgent.indexOf('Chrome') > -1 && userAgent.indexOf('Edg') === -1) {
                browserName = 'Chrome';
                const match = userAgent.match(/Chrome\/(\d+\.\d+)/);
                browserVersion = match ? match[1] : 'æœªçŸ¥';
            } else if (userAgent.indexOf('Firefox') > -1) {
                browserName = 'Firefox';
                const match = userAgent.match(/Firefox\/(\d+\.\d+)/);
                browserVersion = match ? match[1] : 'æœªçŸ¥';
            } else if (userAgent.indexOf('Edg') > -1) {
                browserName = 'Edge';
                const match = userAgent.match(/Edg\/(\d+\.\d+)/);
                browserVersion = match ? match[1] : 'æœªçŸ¥';
            } else if (userAgent.indexOf('Safari') > -1 && userAgent.indexOf('Chrome') === -1) {
                browserName = 'Safari';
                const match = userAgent.match(/Version\/(\d+\.\d+)/);
                browserVersion = match ? match[1] : 'æœªçŸ¥';
            }

            // æ£€æµ‹æ“ä½œç³»ç»Ÿ
            if (userAgent.indexOf('Windows') > -1) os = 'Windows';
            else if (userAgent.indexOf('Mac') > -1) os = 'macOS';
            else if (userAgent.indexOf('Linux') > -1) os = 'Linux';
            else if (userAgent.indexOf('Android') > -1) os = 'Android';
            else if (userAgent.indexOf('iOS') > -1) os = 'iOS';

            browserInfo.innerHTML = `
                <div class="info-item">
                    <div class="info-label">æµè§ˆå™¨</div>
                    <div class="info-value">${browserName} ${browserVersion}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">æ“ä½œç³»ç»Ÿ</div>
                    <div class="info-value">${os}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ç”¨æˆ·ä»£ç†</div>
                    <div class="info-value" style="font-size: 12px;">${userAgent}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">å±å¹•åˆ†è¾¨ç‡</div>
                    <div class="info-value">${screen.width} Ã— ${screen.height}</div>
                </div>
            `;
        }

        // æ›´æ–°GPUä¿¡æ¯
        function updateGPUInfo(renderer, vendor) {
            const gpuInfo = document.getElementById('gpu-info');
            gpuInfo.innerHTML = `
                <div class="info-item">
                    <div class="info-label">GPUæ¸²æŸ“å™¨</div>
                    <div class="info-value">${renderer}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">GPUä¾›åº”å•†</div>
                    <div class="info-value">${vendor}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">é¢œè‰²æ·±åº¦</div>
                    <div class="info-value">${screen.colorDepth}ä½</div>
                </div>
                <div class="info-item">
                    <div class="info-label">åƒç´ æ¯”ä¾‹</div>
                    <div class="info-value">${window.devicePixelRatio}</div>
                </div>
            `;
        }

        // æ€§èƒ½æµ‹è¯•
        function runPerformanceTest() {
            const resultDiv = document.getElementById('performance-result');
            resultDiv.className = 'result';
            resultDiv.innerHTML = 'æ€§èƒ½æµ‹è¯•ä¸­...';

            setTimeout(() => {
                const startTime = performance.now();
                let operations = 0;

                // æ‰§è¡Œä¸€äº›è®¡ç®—æ“ä½œ
                for (let i = 0; i < 1000000; i++) {
                    operations += Math.sqrt(i) * Math.random();
                }

                const endTime = performance.now();
                const duration = endTime - startTime;

                let performanceLevel = 'ä¼˜ç§€';
                let className = 'success';

                if (duration > 100) {
                    performanceLevel = 'ä¸€èˆ¬';
                    className = 'warning';
                }
                if (duration > 500) {
                    performanceLevel = 'è¾ƒå·®';
                    className = 'error';
                }

                resultDiv.className = `result ${className}`;
                resultDiv.innerHTML = `
                    âš¡ æ€§èƒ½æµ‹è¯•å®Œæˆ<br>
                    <strong>è€—æ—¶:</strong> ${duration.toFixed(2)} æ¯«ç§’<br>
                    <strong>æ€§èƒ½ç­‰çº§:</strong> ${performanceLevel}<br>
                    <strong>æ“ä½œæ•°:</strong> 1,000,000 æ¬¡
                `;
            }, 100);
        }

        // æµ‹è¯•Three.jsæ¸²æŸ“
        function testThreeJS() {
            const resultDiv = document.getElementById('performance-result');
            resultDiv.className = 'result';
            resultDiv.innerHTML = 'åŠ è½½Three.jsæµ‹è¯•...';

            // åŠ¨æ€åŠ è½½Three.js
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js';
            script.onload = () => {
                try {
                    const testCanvas = document.createElement('canvas');
                    testCanvas.width = 400;
                    testCanvas.height = 300;
                    testCanvas.style.border = '2px solid #444';
                    testCanvas.style.margin = '10px 0';

                    const scene = new THREE.Scene();
                    const camera = new THREE.PerspectiveCamera(75, 400/300, 0.1, 1000);
                    const renderer = new THREE.WebGLRenderer({ canvas: testCanvas, antialias: false });

                    const geometry = new THREE.BoxGeometry();
                    const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
                    const cube = new THREE.Mesh(geometry, material);
                    scene.add(cube);

                    camera.position.z = 5;

                    let frameCount = 0;
                    const startTime = performance.now();

                    function animate() {
                        frameCount++;
                        cube.rotation.x += 0.01;
                        cube.rotation.y += 0.01;
                        renderer.render(scene, camera);

                        if (frameCount < 60) {
                            requestAnimationFrame(animate);
                        } else {
                            const endTime = performance.now();
                            const fps = (frameCount / ((endTime - startTime) / 1000)).toFixed(1);

                            resultDiv.className = 'result success';
                            resultDiv.innerHTML = `
                                âœ… Three.jsæ¸²æŸ“æµ‹è¯•å®Œæˆ<br>
                                <strong>å¹³å‡FPS:</strong> ${fps}<br>
                                <strong>æ¸²æŸ“å¸§æ•°:</strong> ${frameCount}<br>
                                <strong>æµ‹è¯•æ—¶é•¿:</strong> ${((endTime - startTime)/1000).toFixed(2)}ç§’
                            `;
                            resultDiv.appendChild(testCanvas);
                        }
                    }

                    animate();
                } catch (error) {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `âŒ Three.jsæµ‹è¯•å¤±è´¥: ${error.message}`;
                }
            };

            script.onerror = () => {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = 'âŒ æ— æ³•åŠ è½½Three.jsåº“';
            };

            document.head.appendChild(script);
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæ£€æµ‹
        window.onload = function() {
            updateBrowserInfo();
            testWebGL();
        };
    </script>
</body>
</html>